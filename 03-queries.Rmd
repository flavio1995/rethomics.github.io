# Working with queries{#queries -}


![todo figure]()

When performing many experiments, with multiple condidions and replicates,
it becomes challenging to keep track of each individual and to link it to its actual data.
In `rethomics`, regardless of the tool used to generate data, loading results always involves a query.
**A query is a simple CSV file** (basically a spreadsheet) in which **each row defines one unique animal**.
The query contains technical information (column) such as "date", "name of the machine used" and others.
They will be used to match an animal to its data.
In addition, it records arbitrary biological information describing the experiment.
For instance, this is a toy query with only 3 animals:

  ```{r, echo=FALSE}
library(knitr)
dd <- data.frame(
  date=c("2015-02-20", "2015-02-20","2015-02-20"),
  machine_name = c("machine_01","machine_03","machine_07"),
  region_id = c(1,2,1),
  sex=c("M", "F", "F"),
  genotype=c("xxx", "xxx", "zzz"))

kable(dd,
      row.names = FALSE)
```



The `region_id` column define the region of interest in the behavioural arena.

When performing a replicates of an experiment, it is very simple to expand a pre-existing query:
  ```{r, echo=FALSE}
dd2 <- dd
dd2$date <- "2015-03-05"
dd$replicate <- "A"
dd2$replicate <- "B"
dd <- rbind(dd,dd2)
kable(dd,
      row.names = FALSE)
```

It is a good habit to *record as much information as possible in our queries* -- even if it seems redundant.
For instance, if we put animals in different incubators, we can simply add an "incubator" column in our query:

  ```{r, echo=FALSE}


dd$incubator <- ifelse(dd$region_id <2, 3,4)
kable(dd,
      row.names = FALSE)
```

This way, we keep all our experimental notes, as much as possible, inside one file.
Not only this will help us to "debug" if anything goes wrong in one incubator, but we will also be able to account for incubator as a covariate later on.

According to the acquicisition platform (e.g. ethoscopes and DAMS), the queries may be slightly different, and we will show examples of such queries in the next parts of the tutorial.
Regardless of the acquisition, though, **queries are a canonical way to both record and load behavioural data**.
They are both computer and human friendly. In other words, if you give a query to a colaborator, she/he will be able to tell very quickly what animal underwent which treatment, where and when.
