<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Rethomics, a framework for high-throughput behaviour analysis in R</title>
  <meta name="description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in <code>R</code>.">
  <meta name="generator" content="bookdown 0.5.10 and GitBook 2.6.7">

  <meta property="og:title" content="Rethomics, a framework for high-throughput behaviour analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in <code>R</code>." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Rethomics, a framework for high-throughput behaviour analysis in R" />
  
  <meta name="twitter:description" content="This is a tutorial for Rethomics, a framework to analyse high-throuput behavioural data in <code>R</code>." />
  

<meta name="author" content="Quentin Geissmann">


<meta name="date" content="2017-11-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="damr.html">
<link rel="next" href="ggetho.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rethomics Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>First Steps</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#getting-r"><i class="fa fa-check"></i>Getting R</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#installing-rethomics-packages"><i class="fa fa-check"></i>Installing rethomics packages</a></li>
<li><a href="intro.html#list-of-rethomics-packages">List of <code>rethomics</code> packages</a></li>
</ul></li>
<li><a href="workflow.html#workflow">The <code>rethomics</code> workflow</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i>Working with metadata files</a><ul>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#what-are-metadata"><i class="fa fa-check"></i>What are metadata?</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#make-them-exhaustive"><i class="fa fa-check"></i>Make them exhaustive</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#put-replicates-together"><i class="fa fa-check"></i>Put replicates together</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#linking-metadata"><i class="fa fa-check"></i>Linking metadata</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#take-home-message"><i class="fa fa-check"></i>Take home message</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html"><i class="fa fa-check"></i>behavr tables</a><ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#variables-and-metavariables"><i class="fa fa-check"></i>Variables and metavariables</a></li>
<li><a href="behavr.html#operating-on-behavr-tables">Operating on <code>behavr</code> tables</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#playing-with-toy-data"><i class="fa fa-check"></i>Playing with toy data</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#generalities"><i class="fa fa-check"></i>Generalities</a><ul>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="metadata.html"><a href="metadata.html#metadata"><i class="fa fa-check"></i>Metadata</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#data-metadata"><i class="fa fa-check"></i>Data &amp; Metadata</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#summerise-data"><i class="fa fa-check"></i>Summerise data</a></li>
<li class="chapter" data-level="" data-path="behavr.html"><a href="behavr.html#stitching"><i class="fa fa-check"></i>Stitching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html"><i class="fa fa-check"></i>DAM2 data, in practice</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#getting-the-data"><i class="fa fa-check"></i>Getting the data</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#experiment-design-to-standard-metadata"><i class="fa fa-check"></i>Experiment design to standard metadata</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#our-toy-experiment"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#metadata-1"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#linking"><i class="fa fa-check"></i>Linking</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#loading"><i class="fa fa-check"></i>Loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#note-on-datetime"><i class="fa fa-check"></i>Note on datetime</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#zt0"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#start-and-stop-time"><i class="fa fa-check"></i>Start and stop time</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#quality-control"><i class="fa fa-check"></i>Quality control</a><ul>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#detecting-anomalies"><i class="fa fa-check"></i>Detecting anomalies</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#how-to-exclude-animals"><i class="fa fa-check"></i>How to exclude animals?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#apply-functions-when-loading"><i class="fa fa-check"></i>Apply functions when loading</a></li>
<li class="chapter" data-level="" data-path="damr.html"><a href="damr.html#next-steps"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html"><i class="fa fa-check"></i>Ethoscope data, in practice</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#aims-1"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#background-1"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#getting-the-data-1"><i class="fa fa-check"></i>Getting the data</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#extract-the-zipped-data"><i class="fa fa-check"></i>Extract the zipped data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#note-on-the-data-structure"><i class="fa fa-check"></i>Note on the data structure</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#set-your-working-directory"><i class="fa fa-check"></i>Set your working directory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#experiment-design-to-standard-metadata-1"><i class="fa fa-check"></i>Experiment design to standard metadata</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#our-toy-experiment-1"><i class="fa fa-check"></i>Our toy experiment</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#metadata-2"><i class="fa fa-check"></i>Metadata</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#linking-1"><i class="fa fa-check"></i>Linking</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#local-data"><i class="fa fa-check"></i>Local data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#remote-data"><i class="fa fa-check"></i>Remote Data</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#warnings-and-errors"><i class="fa fa-check"></i>Warnings and errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#loading-1"><i class="fa fa-check"></i>Loading</a><ul>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#default"><i class="fa fa-check"></i>Default</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#preprocessing"><i class="fa fa-check"></i>Preprocessing</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#zt0-1"><i class="fa fa-check"></i>ZT0</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#cache-directory"><i class="fa fa-check"></i>Cache directory</a></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#warnings-and-errors-1"><i class="fa fa-check"></i>Warnings and errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scopr.html"><a href="scopr.html#next-steps-1"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html"><i class="fa fa-check"></i>Visualisation with ggetho</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#aims-2"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#lessons-from-ggplot"><i class="fa fa-check"></i>Lessons from ggplot</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#some-behavioural-data"><i class="fa fa-check"></i>Some behavioural data</a></li>
<li><a href="ggetho.html#the-ggetho-function">The <code>ggetho()</code> function</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#tile-plots"><i class="fa fa-check"></i>Tile plots</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#per-individual"><i class="fa fa-check"></i>Per individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#sorted-individual"><i class="fa fa-check"></i>Sorted individual</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#group-averages"><i class="fa fa-check"></i>Group averages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#population-plots"><i class="fa fa-check"></i>Population plots</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#one-population"><i class="fa fa-check"></i>One population</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#several-populations"><i class="fa fa-check"></i>Several populations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#wrapping-data"><i class="fa fa-check"></i>Wrapping data</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-annotations"><i class="fa fa-check"></i>LD annotations</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#basics"><i class="fa fa-check"></i>Basics</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#changing-ld-colours"><i class="fa fa-check"></i>Changing LD colours</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#ld-in-the-background"><i class="fa fa-check"></i>LD in the background</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#phase-and-period"><i class="fa fa-check"></i>Phase and period</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#regime-change"><i class="fa fa-check"></i>Regime change</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-and-scales"><i class="fa fa-check"></i>Coordinate and scales</a><ul>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#plot-limits"><i class="fa fa-check"></i>Plot limits</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#time-scale-units"><i class="fa fa-check"></i>Time scale units</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#coordinate-systems"><i class="fa fa-check"></i>Coordinate systems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#periodograms"><i class="fa fa-check"></i>Periodograms</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#miscelaneous"><i class="fa fa-check"></i>Miscelaneous</a></li>
<li class="chapter" data-level="" data-path="ggetho.html"><a href="ggetho.html#next-steps-2"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/yihui/bookdown/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rethomics, a framework for high-throughput behaviour analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scopr" class="section level1 unnumbered">
<h1>Ethoscope data, in practice</h1>
<p><strong>TODO</strong></p>
<hr />
<div class="figure">
<img src="assets/ethoscope_experiment.png" alt="An ethoscope experiment. todo" />
<p class="caption">An ethoscope experiment. todo</p>
</div>
<div id="aims-1" class="section level2 unnumbered">
<h2>Aims</h2>
<p>In this practical chapter, we will use a real experiment to learn how to:</p>
<ul>
<li>Translate your experiment design into a metadata file</li>
<li>Use this metadata file to load some data</li>
<li>Set the circadian reference (ZT0)</li>
<li>Assess graphically the quality of the data</li>
<li>Optimise your code to save time and RAM</li>
<li>Use good practices to exclude individuals from our experiments</li>
</ul>
</div>
<div id="prerequisites-1" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<ul>
<li>You are familiar with the <a href="http://gilestrolab.github.io/ethoscope/">Ethoscope Platform</a></li>
<li>Ensure you have read about the <a href="workflow.html">rethomics workflow</a> and <a href="metadata.html">metadata</a></li>
<li>Ensure you have <a href="intro.html#installing-rethomics-packages">installed</a> <code>behavr</code>, <code>scopr</code> and <code>ggetho</code> packages:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">&quot;rethomics/behavr&quot;</span>)
<span class="kw">install_github</span>(<span class="st">&quot;rethomics/scopr&quot;</span>)
<span class="kw">install_github</span>(<span class="st">&quot;rethomics/ggetho&quot;</span>)</code></pre></div>
</div>
<div id="background-1" class="section level2 unnumbered">
<h2>Background</h2>
<p><a href="http://gilestrolab.github.io/ethoscope/">The Ethoscope Platform</a> is a versatile and modular behavioural system to sudy behaviour of small animals. You can read more about it in our <a href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.2003026">PLOS Biology publication</a>. Although you can do much more with them, ethoscope are primarily designed to study sleep and circadian rhythms in Drosophila. Therefore, we will work in this context for this tutorial.</p>
<p>Ethoscopes typically generate hundreads of megabytes per machine per week. The platform is designed so that many devices run n parallel, and the resulting data is eventually centralised for all users. Metadata tables are the best way to both keep track of your expriments and fetch the relevant data.</p>
</div>
<div id="getting-the-data-1" class="section level2 unnumbered">
<h2>Getting the data</h2>
<div id="extract-the-zipped-data" class="section level3 unnumbered">
<h3>Extract the zipped data</h3>
<p>Since ethoscopes generate <strong>large amount of data</strong>, compared to DAM, we will work only with a few animals. A zip containing data for this tutorial is available on <a href="todo.html">zenodo</a> Since will download the data.</p>
<p>Start by downloading and extracting the zip somewhere in your computer.</p>
<p>Store this location as a variable:</p>
<pre class="r{eval=f}"><code>DATA_DIR &lt;- &quot;C://Where/My/Zip/Has/been/extracted</code></pre>
<p>Check that all the files live there:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(DATA_DIR)</code></pre></div>
<pre><code>## [1] &quot;ethoscope_results&quot;      &quot;ethoscope_tutorial.zip&quot;
## [3] &quot;metadata.csv&quot;</code></pre>
<p>We have: * The metadata file that I have prepared for you * An <code>ethoscope_results</code> directory</p>
</div>
<div id="note-on-the-data-structure" class="section level3 unnumbered">
<h3>Note on the data structure</h3>
<p>It is informative to take a look at the latter. Files are organised as <machine_id>/<machine_name>/<datetime>/<file>:</p>
<pre><code>ethoscope_results
├── 008d6ba04e534be486069c3db7b10827
│   └── ETHOSCOPE_008
│       └── 2016-07-29_14-57-35
│           └── 2016-07-29_14-57-35_008d6ba04e534be486069c3db7b10827.db
├── 009d6ba04e534be486069c3db7b10827
│   └── ETHOSCOPE_009
│       └── 2016-07-22_16-43-29
│           └── 2016-07-22_16-43-29_009d6ba04e534be486069c3db7b10827.db
└── 011d6ba04e534be486069c3db7b10827
    └── ETHOSCOPE_011
        ├── 2016-07-22_16-41-21
        │   └── 2016-07-22_16-41-21_011d6ba04e534be486069c3db7b10827.db
        └── 2016-07-29_14-59-49
            └── 2016-07-29_14-59-49_011d6ba04e534be486069c3db7b10827.db</code></pre>
<p>Tracking data are saved in <code>.db</code> files. Everytime an ethoscope is started, one <code>.db</code> new file is created. All animals presents in the same machine at the same time will have their data saved in the same time.</p>
</div>
<div id="set-your-working-directory" class="section level3 unnumbered">
<h3>Set your working directory</h3>
<p>For this tutorial, we can just <a href="https://support.rstudio.com/hc/en-us/articles/200711843-Working-Directories-and-Workspaces">set our working directory</a> to <code>DATA_DIR</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(DATA_DIR)</code></pre></div>
</div>
</div>
<div id="experiment-design-to-standard-metadata-1" class="section level2 unnumbered">
<h2>Experiment design to standard metadata</h2>
<div id="our-toy-experiment-1" class="section level3 unnumbered">
<h3>Our toy experiment</h3>
<div class="figure">
<img src="assets/ethoscope_experiment.png" alt="A DAM experiment. Two replicates, 10 days apart; three genotypes; two sexes, males and females" />
<p class="caption">A DAM experiment. Two replicates, 10 days apart; three genotypes; two sexes, males and females</p>
</div>
</div>
<div id="metadata-2" class="section level3 unnumbered">
<h3>Metadata</h3>
<p><strong>It is crucial that you have read <a href="metadata.html">metadata chapter</a></strong> to understand this part. Our goal is to encode our whole experiment in a single file in which:</p>
<ul>
<li>each row is an individual</li>
<li>each column is a metavariable</li>
</ul>
<p>Luckily for you, I have already put this file together for you as <code>metadata.csv</code>! Lets have a look at it (you can use <code>R</code>, excel or whatever you want). If you are using <code>R</code>, type this commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scopr)
metadata &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;metadata.csv&quot;</span>)
metadata</code></pre></div>
<pre><code>##      machine_name       date region_id treatment
##  1: ETHOSCOPE_011 2016-07-22         1         B
##  2: ETHOSCOPE_011 2016-07-22         2         A
##  3: ETHOSCOPE_011 2016-07-22         3         B
##  4: ETHOSCOPE_011 2016-07-22         4         B
##  5: ETHOSCOPE_011 2016-07-22         5         B
##  6: ETHOSCOPE_011 2016-07-22         6         A
##  7: ETHOSCOPE_011 2016-07-22         7         B
##  8: ETHOSCOPE_011 2016-07-22         8         A
##  9: ETHOSCOPE_011 2016-07-22         9         A
## 10: ETHOSCOPE_011 2016-07-22        10         B
## 11: ETHOSCOPE_011 2016-07-22        11         A
## 12: ETHOSCOPE_011 2016-07-22        12         B
## 13: ETHOSCOPE_011 2016-07-22        13         B
## 14: ETHOSCOPE_011 2016-07-22        14         A
## 15: ETHOSCOPE_011 2016-07-22        15         A
## 16: ETHOSCOPE_011 2016-07-22        16         B
## 17: ETHOSCOPE_011 2016-07-22        17         B
## 18: ETHOSCOPE_011 2016-07-22        18         B
## 19: ETHOSCOPE_011 2016-07-22        19         A
## 20: ETHOSCOPE_011 2016-07-22        20         B
## 21: ETHOSCOPE_009 2016-07-22         1         B
## 22: ETHOSCOPE_009 2016-07-22         2         B
## 23: ETHOSCOPE_009 2016-07-22         3         B
## 24: ETHOSCOPE_009 2016-07-22         4         B
## 25: ETHOSCOPE_009 2016-07-22         5         B
## 26: ETHOSCOPE_009 2016-07-22         6         B
## 27: ETHOSCOPE_009 2016-07-22         7         B
## 28: ETHOSCOPE_009 2016-07-22         8         A
## 29: ETHOSCOPE_009 2016-07-22         9         B
## 30: ETHOSCOPE_009 2016-07-22        10         B
## 31: ETHOSCOPE_009 2016-07-22        11         B
## 32: ETHOSCOPE_009 2016-07-22        12         B
## 33: ETHOSCOPE_009 2016-07-22        13         B
## 34: ETHOSCOPE_009 2016-07-22        14         B
## 35: ETHOSCOPE_009 2016-07-22        15         B
## 36: ETHOSCOPE_009 2016-07-22        16         A
## 37: ETHOSCOPE_009 2016-07-22        17         A
## 38: ETHOSCOPE_009 2016-07-22        18         B
## 39: ETHOSCOPE_009 2016-07-22        19         B
## 40: ETHOSCOPE_009 2016-07-22        20         A
## 41: ETHOSCOPE_008 2016-07-29         1         A
## 42: ETHOSCOPE_008 2016-07-29         2         A
## 43: ETHOSCOPE_008 2016-07-29         3         B
## 44: ETHOSCOPE_008 2016-07-29         4         A
## 45: ETHOSCOPE_008 2016-07-29         5         B
## 46: ETHOSCOPE_008 2016-07-29         6         A
## 47: ETHOSCOPE_008 2016-07-29         7         A
## 48: ETHOSCOPE_008 2016-07-29         8         A
## 49: ETHOSCOPE_008 2016-07-29         9         A
## 50: ETHOSCOPE_008 2016-07-29        10         B
## 51: ETHOSCOPE_008 2016-07-29        11         A
## 52: ETHOSCOPE_008 2016-07-29        12         B
## 53: ETHOSCOPE_008 2016-07-29        13         A
## 54: ETHOSCOPE_008 2016-07-29        14         A
## 55: ETHOSCOPE_008 2016-07-29        15         B
## 56: ETHOSCOPE_008 2016-07-29        16         A
## 57: ETHOSCOPE_008 2016-07-29        17         A
## 58: ETHOSCOPE_008 2016-07-29        18         A
## 59: ETHOSCOPE_008 2016-07-29        19         A
## 60: ETHOSCOPE_008 2016-07-29        20         A
## 61: ETHOSCOPE_011 2016-07-29         1         B
## 62: ETHOSCOPE_011 2016-07-29         2         A
## 63: ETHOSCOPE_011 2016-07-29         3         A
## 64: ETHOSCOPE_011 2016-07-29         4         A
## 65: ETHOSCOPE_011 2016-07-29         5         B
## 66: ETHOSCOPE_011 2016-07-29         6         B
## 67: ETHOSCOPE_011 2016-07-29         7         B
## 68: ETHOSCOPE_011 2016-07-29         8         A
## 69: ETHOSCOPE_011 2016-07-29         9         B
## 70: ETHOSCOPE_011 2016-07-29        10         A
## 71: ETHOSCOPE_011 2016-07-29        11         A
## 72: ETHOSCOPE_011 2016-07-29        12         A
## 73: ETHOSCOPE_011 2016-07-29        13         A
## 74: ETHOSCOPE_011 2016-07-29        14         A
## 75: ETHOSCOPE_011 2016-07-29        15         A
## 76: ETHOSCOPE_011 2016-07-29        16         B
## 77: ETHOSCOPE_011 2016-07-29        17         A
## 78: ETHOSCOPE_011 2016-07-29        18         A
## 79: ETHOSCOPE_011 2016-07-29        19         A
## 80: ETHOSCOPE_011 2016-07-29        20         B
##      machine_name       date region_id treatment</code></pre>
<p>Each of the 80 animals (rows) is defined by two mandatory columns (metavariables):</p>
<ul>
<li><code>machine_name</code> – the name of the device used (e.g. <code>&quot;ETHOSCOPE_001&quot;</code>)</li>
<li><code>date</code> – the date and time (<code>YYYY-MM-DD</code>) of the start of the experiment.</li>
</ul>
<p>In this experiment, we have only one condition, for simplicity. We define it as a custom column in the metadata (note that you could define many, with arbitrary names):</p>
<ul>
<li><code>treatment</code> – A or B</li>
</ul>
</div>
</div>
<div id="linking-1" class="section level2 unnumbered">
<h2>Linking</h2>
<p><a href="metadata.html#linking-metadata">Linking</a> is the one necessary step before loading the data. It allocates a unique identifier to each animal.</p>
<div id="local-data" class="section level3 unnumbered">
<h3>Local data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metadata &lt;-<span class="st"> </span><span class="kw">link_ethoscope_metadata</span>(metadata, 
                                    <span class="dt">result_dir =</span> <span class="st">&quot;ethoscope_results&quot;</span>)
metadata</code></pre></div>
<p>```</p>
</div>
<div id="remote-data" class="section level3 unnumbered">
<h3>Remote Data</h3>
</div>
<div id="warnings-and-errors" class="section level3 unnumbered">
<h3>Warnings and errors</h3>
</div>
</div>
<div id="loading-1" class="section level2 unnumbered">
<h2>Loading</h2>
<div id="default" class="section level3 unnumbered">
<h3>Default</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metadata_subset &lt;-<span class="st"> </span>metadata[region_id <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]
dt &lt;-<span class="st"> </span><span class="kw">load_ethoscope</span>(metadata_subset, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">summary</span>(dt)</code></pre></div>
<pre><code>## behavr table with:
##  4   individuals
##  6   metavariables
##  8   variables
##  3.004648e+06    measurements
##  1   key (id)</code></pre>
</div>
<div id="preprocessing" class="section level3 unnumbered">
<h3>Preprocessing</h3>
</div>
<div id="zt0-1" class="section level3 unnumbered">
<h3>ZT0</h3>
</div>
<div id="cache-directory" class="section level3 unnumbered">
<h3>Cache directory</h3>
</div>
<div id="warnings-and-errors-1" class="section level3 unnumbered">
<h3>Warnings and errors</h3>
</div>
</div>
<div id="next-steps-1" class="section level2 unnumbered">
<h2>Next steps</h2>
<ul>
<li><a href="ggetho.html">Visualise data with <code>ggetho</code></a></li>
<li><a href="sleepr.html">Sleep analysis with <code>sleepr</code></a></li>
<li><a href="zeitgebr.html">Circadian analysis with <code>zeitgebr</code></a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="damr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggetho.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rethomics/rethomics.github.io/edit/source/06-scopr.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
